{{- $cateName := .Category.Name -}}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="{{.Category.Keywords}}">
<meta name="description" content="{{.Category.Description}}">
<title>{{$cateName}}-{{ .Site.name }}</title>
<link rel="stylesheet" href="/static/main.css">
</head>
<body>
<header class="header">
    <section class="top">
        <h1>{{.Site.name}}</h1>
        <p>{{.Site.summary}}</p>
    </section>
    <nav class="nav">
        <a href="/" class="nav-item">首页</a>
        {{- range .Categories -}}
        {{- if eq .Published true }}
        <a href="/{{.Slug}}" class="nav-item {{if eq .Slug $.Category.Slug}} active {{end}}">{{.Name}}</a>
        {{- end }}
        {{- end -}}
    </nav>
</header>
<main>
    <section>
        <header>
            <h2>{{ $cateName}}</h2><!-- <h2><a href="/{{.Category.Slug}}">{{ $cateName}}</a></h2> -->
            <p>{{ .Category.Description }}</p>
        </header>
        <article class="article">
            {{- range .Data.DocumentList }} {{- if .Published }}
            <div class="site">
                <div class="site-header">
                    <h3>{{.Name}}</h3>
                    <h4>{{$cateName}}</h4>
                </div>
                <a class="link" href="/article/{{.Slug}}">{{.Url}}</a><!-- <a class="link" href="{{.Url}}" target="_blank">{{.Url}}</a> -->
                <p>{{.Description}}</p>
                <div class="site-footer">
                    <a class="btn" href="{{.Url}}" target="_blank">访问网站</a>
                    <nav class="tags">
                        {{- range .Tags }}
                        <a href="/tag/{{.}}">{{.}}</a><!-- <span>{{.}}</span> -->
                        {{- end }}
                    </nav>
                </div>
            </div>
            {{- end -}} {{- end }}
        </article>
    </section>
    <footer>
        {{- with .Site.copyright}}
        <p>&copy; {{$.Site.name}} - {{- . -}}</p>
        {{- end }}
    </footer>
</main>
<div class="float-controls">
    <button class="mobile-menu">
        <i class="mobile-icon"></i>
    </button>
    <button class="theme-btn">
        <i class="theme-icon"></i>
    </button>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const mainElement = document.querySelector('main');
    const mobileMenuElement = document.querySelector('.mobile-menu');
    const mobileMenuIconElement = document.querySelector('.mobile-menu i');
    const asideElement = document.querySelector('.header');
    
    const themeBtn = document.querySelector(".theme-btn");
    
    themeBtn.addEventListener("click", function (e) {
        e.preventDefault();
        const isDark = document.body.classList.contains("light-theme");
        if (isDark) {
            document.body.classList.remove("light-theme")
        } else {
            document.body.classList.add("light-theme")
        }

        localStorage.setItem("navTheme", isDark ? "dark" : "light");
    });

    // 加载保存的主题
    const savedTheme = localStorage.getItem("navTheme");
    if (savedTheme === "light") {
        document.body.classList.add("light-theme");
    }

    mobileMenuElement.addEventListener('click', function (e) {
        e.preventDefault();
        if (asideElement.classList.contains("aside--100")) {
            asideElement.classList.remove("aside--100")
            asideElement.classList.add("aside-0")
            mobileMenuIconElement.classList.remove("mobile-icon")
            mobileMenuIconElement.classList.add("mobile-close-icon")
        } else {
            asideElement.classList.remove("aside-0")
            asideElement.classList.add("aside--100")
            mobileMenuIconElement.classList.remove("mobile-close-icon")
            mobileMenuIconElement.classList.add("mobile-icon")
        }
    })

    function mobileChange() {
        if (window.innerWidth > 1024) {
            if (asideElement.classList.contains("aside--100")) {
                asideElement.classList.remove("aside--100")
                asideElement.classList.add("aside-0")
                mobileMenuIconElement.classList.remove("mobile-icon")
                mobileMenuIconElement.classList.add("mobile-close-icon")
            }
        } else {
            asideElement.classList.remove("aside-0")
            asideElement.classList.add("aside--100")
            mobileMenuIconElement.classList.remove("mobile-close-icon")
            mobileMenuIconElement.classList.add("mobile-icon")
        }
    }

    mobileChange();

    let resizeTimer;
    window.addEventListener("resize", () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            mobileChange();
        }, 30);
    });
});
</script>
</body>
</html>